# 🐓 מערכת ניהול הזמנות Zoares

מערכת ניהול הזמנות מתקדמת לבעלי עסקים עם תכונות מתקדמות לניהול הזמנות, לקוחות וניתוח נתונים.

## 👨‍💻 מפתח המערכת
**פותח על ידי:** ירון זוארס

---

## ✨ תכונות חדשות

### 🔄 ניהול הזמנות אוטומטי
- **הזמנות פעילות**: הזמנות לא סופקות נשמרות עד 20 ימי עסקים
- **הזמנות סגורות**: הזמנות שהושלמו נשמרות עד 5 שנים
- **ניקוי אוטומטי**: המערכת מנקה הזמנות ישנות אוטומטית
- **מספור אוטומטי**: כל הזמנה מקבלת מספר ייחודי

### 👥 ניהול לקוחות מתקדם
- **בסיס נתונים משותף**: קישור בין אפליקציית הלקוחות לאפליקציית המנהל
- **נתוני לקוחות**: שמירת פרטי לקוח, היסטוריית הזמנות וסטטיסטיקות
- **שמירה ל-365 ימים**: נתוני לקוחות נשמרים למשך שנה
- **ניקוי אוטומטי**: מחיקת לקוחות שלא הזמינו מעל שנה

### 📊 ניתוח נתונים מתקדם
- **ניתוח לקוחות**: גרפים וסטטיסטיקות לפי לקוחות
- **ניתוח מוצרים**: פופולריות מוצרים לפי לקוחות
- **ניתוח זמנים**: הזמנות לפי חודשים
- **הורדת נתונים**: אפשרות להורדת נתונים בפורמט CSV

### 📋 לשוניות נפרדות
- **הזמנות פעילות**: הזמנות שעדיין בטיפול
- **הזמנות סגורות**: הזמנות שהושלמו או נסגרו
- **ניהול לקוחות**: ניהול וניתוח נתוני לקוחות
- **ניתוח מתקדם**: ניתוחים מתקדמים עם קישור ללקוחות
- **כפתור סגירה**: אפשרות לסגור הזמנה ולהעבירה להזמנות סגורות

### 🍗 מוצרים חדשים וקטגוריות
- **קטגוריית הודו**: הודו שלם נקבה, חזה הודו נקבה, שווארמה הודו נקבה, קורקבן הודו נקבה, כנפיים הודו נקבה, שוקיים הודו נקבה, לבבות הודו נקבה, גרון הודו, ביצי הודו
- **קטגוריית המבורגר הבית**: המבורגר הבית (ללא מגבלת משקל/יחידות)
- **מוצרים חדשים בעופות**: קורקבן עוף, טחול עוף, טחון מיוחד (שווארמה נקבה, פרגית וחזה עוף)
- **מוצרים חדשים בבשר**: פילה פרמיום, טחון קוקטייל הבית

### 🔪 אפשרויות חיתוך מורחבות
- **עוף שלם**: שלם, פרוס לשניצל, פרוס ל-8 חלקים, עוף פרוס לשניצל ללא עור, עוף פרוס ל-8 חלקים ללא עור
- **שניצל עוף**: שניצל פרוס עבה, שניצל פרוס דק
- **כרעיים עוף**: שלם, חצוי, שלם בלי עור, חצוי בלי עור
- **ירכיים**: עם עור, בלי עור
- **שוקיים עוף**: שוקיים עם עור, שוקיים בלי עור
- **שווארמה עוף**: חתוך לשיפודים, רצועות, פרוס דק, סטיק פרגית
- **שווארמה הודו נקבה**: חתוך לשיפודים, רצועות, פרוס, שלם

### 📱 אינטגרציה עם וואטסאפ
- **כפתור וואטסאפ מהיר**: פתיחת שיחה ישירה עם הלקוח
- **הודעות מוכנות**: הודעות אוטומטיות עם פרטי ההזמנה
- **פורמט מספר טלפון**: המרה אוטומטית לפורמט בינלאומי
- **הודעות מפורטות**: כולל פרטי הזמנה, כתובת והערות

### 🚚 עדכוני משלוח
- **עלות משלוח לבני ברק**: 20 ש"ח (עודכן מ-15 ש"ח)
- **עלות משלוח מחוץ לבני ברק**: 25 ש"ח
- **שעות פעילות**: א'-ה' 6:00-14:00, ו' 6:00-12:00 (עודכן מ-6:00-14:00)

### 🛒 אפליקציית לקוחות משופרת
- **עופות טריים ארוזים**: התאמה אישית לפי בקשת הלקוח ביחידות ו/או במשקל
- **מוצרים מובילים**: הדגשת עופות טריים ארוזים
- **מעקב הזמנות**: חיפוש לפי שם או מספר טלפון
- **עגלת קניות**: ניהול פריטים עם אפשרויות עריכה
- **קישור למנהל**: הזמנות מקושרות לנתוני לקוח במערכת המנהל
- **יישור לימין**: ממשק RTL מותאם לעברית
- **ללא מגבלות**: הזמנה ללא הגבלת משקל או יחידות

## 🗄️ מסד נתונים מרכזי - SQLite

### 📁 מיקום הנתונים
המערכת משתמשת במסד נתונים מרכזי SQLite:
- **קובץ מסד נתונים**: `zoares_central.db`
- **מיקום**: `zoares-order-system/zoares_central.db`
- **גודל נוכחי**: 48KB

### ✅ יתרונות המעבר ל-SQLite
- **סנכרון מיידי**: הזמנות חדשות נראות מיד למנהל
- **נתונים מסונכרנים**: אותו מידע נגיש לכל המחשבים
- **אין כפילויות**: כל הנתונים מרוכזים במקום אחד
- **גיבוי מרכזי**: קובץ מסד נתונים אחד לגיבוי
- **שלמות נתונים**: מניעת אובדן נתונים
- **ביצועים משופרים**: SQLite מהיר יותר מקבצי JSON

### 📊 מבנה מסד הנתונים
הקובץ מכיל 4 טבלאות עיקריות:

1. **`orders`** - הזמנות פעילות
   - `id` - מזהה ייחודי
   - `customer_name` - שם הלקוח
   - `phone` - מספר טלפון
   - `address` - כתובת (JSON)
   - `items` - פריטי ההזמנה (JSON)
   - `status` - סטטוס ההזמנה
   - `created_at` - תאריך יצירה
   - `total_amount` - סכום כולל
   - `customer_id` - קישור ללקוח

2. **`closed_orders`** - הזמנות סגורות
   - אותן עמודות כמו orders
   - `closed_at` - תאריך סגירה

3. **`customers`** - לקוחות
   - `id` - מזהה ייחודי
   - `phone` - מספר טלפון (ייחודי)
   - `full_name` - שם מלא
   - `created_at` - תאריך יצירה
   - `total_orders` - כמות הזמנות
   - `total_spent` - סכום כולל
   - `last_order_date` - הזמנה אחרונה

4. **`order_counter`** - מונה הזמנות
   - `next_order_id` - מספר ההזמנה הבא

### 🔧 ניהול מסד הנתונים
- **קובץ ניהול**: `database.py` - מכיל את כל הפונקציות לניהול מסד הנתונים
- **ייבוא אוטומטי**: המערכת מייבאת אוטומטית נתונים קיימים מקבצי JSON
- **גיבוי**: קבצי JSON המקוריים נשמרים כגיבוי

## 🚀 התקנה והפעלה

### דרישות מערכת
```bash
pip install streamlit pandas matplotlib
```

### הפעלת האפליקציה

#### אפליקציית המנהל (app.py)
אפליקציית המנהל מאפשרת לבעל העסק לנהל הזמנות, לקוחות ולצפות בניתוחי נתונים.

**הפעלה:**
```bash
python -m streamlit run app.py
```

**כתובת גישה:** http://localhost:8501

**תכונות עיקריות:**
- ניהול הזמנות פעילות וסגורות
- ניהול לקוחות וניתוח נתונים
- ניתוח מתקדם עם קישור ללקוחות
- הורדת נתונים בפורמט CSV
- כפתורי וואטסאפ מהירים

#### אפליקציית הלקוחות (customer_app.py)
אפליקציית הלקוחות מאפשרת ללקוחות להזמין מוצרים ולעקוב אחר הזמנותיהם.

**הפעלה:**
```bash
python -m streamlit run customer_app.py --server.port 8505
```

**כתובת גישה:** http://localhost:8505

**תכונות עיקריות:**
- הזמנת מוצרים מכל הקטגוריות
- עגלת קניות מתקדמת
- מעקב הזמנות לפי שם או טלפון
- קישור למערכת המנהל
- יישור לימין (RTL) לממשק עברי
- הזמנה ללא מגבלות משקל או יחידות

#### Windows PowerShell:
```powershell
# עבור לאפליקציית בעל העסק
python -m streamlit run app.py

# עבור לאפליקציית הלקוחות (בטרמינל נפרד)
python -m streamlit run customer_app.py --server.port 8505
```

#### Windows Command Prompt:
```cmd
# עבור לאפליקציית בעל העסק
python -m streamlit run app.py

# עבור לאפליקציית הלקוחות (בטרמינל נפרד)
python -m streamlit run customer_app.py --server.port 8505
```

#### Linux/Mac:
```bash
# עבור לאפליקציית בעל העסק
python -m streamlit run app.py

# עבור לאפליקציית הלקוחות (בטרמינל נפרד)
python -m streamlit run customer_app.py --server.port 8505
```

### כתובות גישה
- **אפליקציית בעל העסק**: http://localhost:8501
- **אפליקציית לקוחות**: http://localhost:8505

### הפעלה במקביל
ניתן להפעיל את שתי האפליקציות במקביל בטרמינלים נפרדים:
```bash
# טרמינל ראשון - מנהל העסק
python -m streamlit run app.py

# טרמינל שני - לקוחות
python -m streamlit run customer_app.py --server.port 8505
```

## 📊 תכונות המערכת

### 🛒 ניהול הזמנות
- **הוספת הזמנות**: יצירת הזמנות חדשות עם פרטי לקוח מלאים
- **עריכת הזמנות**: עדכון פרטי הזמנות קיימות
- **סגירת הזמנות**: העברת הזמנות להזמנות סגורות
- **מחיקת הזמנות**: מחיקה סופית של הזמנות

### 👥 ניהול לקוחות
- **פרטי לקוח**: שם, טלפון, כתובת
- **הערות משלוח**: הערות מיוחדות לשליח
- **היסטוריית הזמנות**: מעקב אחר הזמנות קודמות
- **סטטיסטיקות לקוח**: כמות הזמנות וסכומים
- **ניהול נתונים**: הורדת נתוני לקוחות בפורמט CSV

### 📦 ניהול מוצרים
- **קטגוריות מוצרים**: עופות, בשר, דגים, הודו, המבורגר הבית, אחר
- **מחירים קבועים**: מחירים מוגדרים מראש לכל מוצר
- **מוצרים מותאמים**: אפשרות להוספת מוצרים מותאמים אישית
- **אפשרויות חיתוך**: חיתוך מותאם אישית לכל מוצר
- **מכירה ביחידות ומשקל**: גמישות בבחירת אופן המכירה

### 📊 ניתוח נתונים
- **סטטיסטיקות**: ניתוח הזמנות פעילות וסגורות
- **גרפים**: הצגה ויזואלית של הנתונים (כולל פילוח לפי קטגוריה, פריט, לקוח, חודשים וחגי ישראל)
- **פילוח לפי חודשים**: גרף וטבלה של כמויות הזמנות בכל חודש
- **פילוח לפי חגי ישראל**: גרף וטבלה של כמויות הזמנות בתקופות חגים (פסח, שבועות, ראש השנה, סוכות, חנוכה, פורים)
- **ניתוח לקוחות**: גרפים וסטטיסטיקות לפי לקוחות
- **ניתוח מוצרים**: פופולריות מוצרים לפי לקוחות
- **דוחות**: דוחות מפורטים על ביצועים

## 🔧 הגדרות מערכת

### קבצי נתונים
- `zoares_central.db` - מסד נתונים מרכזי SQLite
- `database.py` - פונקציות ניהול מסד הנתונים
- `orders.json` - גיבוי הזמנות פעילות (ייבוא אוטומטי)
- `closed_orders.json` - גיבוי הזמנות סגורות (ייבוא אוטומטי)
- `customers.json` - גיבוי נתוני לקוחות (ייבוא אוטומטי)

### קבצי אפליקציה
- `app.py` - אפליקציית מנהל העסק
- `customer_app.py` - אפליקציית הלקוחות
- `requirements.txt` - תלויות Python
- `README.md` - מדריך שימוש
- `README_CUSTOMER.md` - מדריך ללקוחות
- `README_DATABASE.md` - מדריך מסד הנתונים

### הגדרות שמירה
- **הזמנות פעילות**: 20 ימי עסקים
- **הזמנות סגורות**: 5 שנים
- **נתוני לקוחות**: 365 ימים
- **ניקוי אוטומטי**: בעת הפעלת האפליקציה

## 📱 ממשק משתמש

### ניווט
- **הזמנות פעילות**: צפייה ועריכת הזמנות בטיפול
- **הזמנות סגורות**: צפייה בהיסטוריית הזמנות
- **הוספת הזמנה**: יצירת הזמנה חדשה
- **עריכת הזמנות**: עדכון הזמנות קיימות
- **ניתוח נתונים**: דוחות וסטטיסטיקות
- **ניהול לקוחות**: ניהול וניתוח נתוני לקוחות
- **ניתוח מתקדם**: ניתוחים מתקדמים עם קישור ללקוחות

### פעולות מהירות
- **הדפסה**: הדפסת הזמנות בפורמט HTML
- **וואטסאפ**: פתיחת שיחה בוואטסאפ עם הלקוח (הודעות מוכנות)
- **סגירה**: סגירת הזמנה והעברה לארכיון
- **ניקוי**: ניקוי ידני של הזמנות ישנות
- **עריכת עגלה**: הוספה, הסרה ועריכת כמות פריטים
- **מעקב הזמנות**: חיפוש לפי שם או מספר טלפון
- **הורדת נתונים**: הורדת נתוני לקוחות בפורמט CSV

## 🎯 יתרונות המערכת

### לבעל העסק
- **ניהול יעיל**: הפרדה בין הזמנות פעילות לסגורות
- **מעקב מדויק**: מספרי הזמנות ייחודיים
- **שמירה אוטומטית**: ניקוי אוטומטי של הזמנות ישנות
- **ניתוח נתונים**: תובנות על ביצועי העסק
- **תקשורת ישירה**: כפתורי וואטסאפ מהירים עם הודעות מוכנות
- **ניהול מוצרים מורחב**: קטגוריות חדשות ואפשרויות חיתוך מתקדמות
- **ניהול לקוחות**: מעקב אחר לקוחות והיסטוריית הזמנות
- **ניתוח מתקדם**: ניתוחים מקיפים עם קישור ללקוחות
- **מסד נתונים מרכזי**: סנכרון מיידי ונתונים מסונכרנים

### ללקוחות
- **מעקב הזמנות**: סטטוס הזמנה מעודכן
- **פרטים מדויקים**: פרטי משלוח והערות
- **היסטוריה**: גישה להיסטוריית הזמנות
- **עופות טריים**: אריזה בהתאמה אישית ביחידות ו/או במשקל
- **אפשרויות חיתוך**: חיתוך מותאם אישית לכל מוצר
- **עגלת קניות מתקדמת**: ניהול קל ונוח של פריטים
- **קישור למנהל**: הזמנות מקושרות לנתוני לקוח במערכת המנהל
- **ממשק עברי**: יישור לימין וטקסט בעברית
- **ללא מגבלות**: הזמנה ללא הגבלת משקל או יחידות

## 🔒 אבטחה ופרטיות
- **נתונים מקומיים**: כל הנתונים נשמרים מקומית
- **גיבוי אוטומטי**: שמירה אוטומטית של הנתונים
- **גישה מוגבלת**: רק למשתמשים מורשים
- **שמירת פרטיות**: נתוני לקוחות נשמרים למשך שנה בלבד
- **מסד נתונים מאובטח**: SQLite עם מניעת נזק לנתונים

## 📞 תמיכה
לשאלות ותמיכה טכנית, פנה אל צוות הפיתוח.

---

**Zoares - מערכת ניהול הזמנות המתקדמת** 🐓 

## 🛠️ תקלות נפוצות ופתרונות

### שגיאת ValueError: list.remove(x): x not in list
- **בעיה:** השגיאה נגרמת כאשר מנסים למחוק אובייקט הזמנה שהוא עותק ולא האובייקט המקורי שברשימה.
- **פתרון:** המערכת כעת מסירה הזמנות לפי מזהה (`id`) ולא לפי אובייקט, כך שהבעיה לא תחזור.

### סנכרון רשימת ההזמנות
- כל פעולה של מחיקה/סגירה/עדכון מתבצעת על פי מזהה ייחודי, מה שמבטיח סנכרון מלא בין התצוגה לקבצי הנתונים.

### קישור בין אפליקציות
- **מסד נתונים מרכזי**: SQLite משותף בין אפליקציית הלקוחות למנהל
- **סנכרון נתונים**: הזמנות מקושרות לנתוני לקוח במערכת המנהל
- **ניקוי אוטומטי**: מחיקת נתונים ישנים בשתי האפליקציות

### בעיות הרצה
- **בעיה**: "File does not exist" בעת הרצת האפליקציות
- **פתרון**: יש לוודא שהאפליקציה רצה מהתיקייה הנכונה (`zoares-order-system`)
- **פקודה**: `cd zoares-order-system` לפני הרצת האפליקציות

### בעיות PowerShell
- **בעיה**: שגיאת `&&` ב-PowerShell
- **פתרון**: להשתמש ב-`;` במקום `&&` או להריץ פקודות בנפרד

### בעיות מסד נתונים
- **בעיה**: "database is locked" בעת פתיחת קובץ `zoares_central.db`
- **פתרון**: וודא שהאפליקציה סגורה לפני פתיחת הקובץ
- **כלי מומלץ**: השתמש ב-DB Browser for SQLite לצפייה בנתונים

## ℹ️ עדכונים אחרונים

### 🆕 עדכונים חדשים (אוגוסט 2025)
- **מסד נתונים מרכזי SQLite**: מעבר מקבצי JSON למסד נתונים מרכזי
- **בסיס נתונים משותף**: קישור בין אפליקציית הלקוחות למנהל
- **ניהול לקוחות**: ניהול וניתוח נתוני לקוחות
- **ניתוח מתקדם**: ניתוחים מקיפים עם קישור ללקוחות
- **שמירת נתונים**: נתוני לקוחות נשמרים ל-365 ימים
- **קטגוריית הודו:** הוספת קטגוריה חדשה עם מוצרי הודו מגוונים (כולל "נקבה" למוצרים רלוונטיים)
- **קטגוריית המבורגר הבית:** המבורגר הבית ללא מגבלות הזמנה
- **מוצרים חדשים:** קורקבן עוף, טחול עוף, טחון מיוחד, פילה פרמיום, טחון קוקטייל הבית
- **אפשרויות חיתוך מורחבות:** חיתוך מתקדם לכל סוגי העופות והבשר
- **אינטגרציה עם וואטסאפ:** כפתורים מהירים עם הודעות מוכנות
- **עדכון עלויות משלוח:** בני ברק 20 ש"ח, מחוץ לבני ברק 25 ש"ח
- **עדכון שעות פעילות:** יום שישי 6:00-12:00
- **עופות טריים ארוזים:** התאמה אישית ביחידות ו/או במשקל
- **יישור לימין:** ממשק RTL מותאם לעברית
- **ללא מגבלות:** הזמנה ללא הגבלת משקל או יחידות
- **תיקון "עגלה ריקה":** הודעת הצלחה לאחר הזמנה במקום "עגלה ריקה"
- **ניקוי תיקיות כפולות:** הסרת תיקיות וקבצים מיותרים

### 🔧 שיפורים טכניים
- **מעבר ל-SQLite**: שיפור ביצועים וסנכרון נתונים
- **תיקון סנכרון:** הסרת הזמנות מתבצעת לפי מזהה (`id`) בלבד, למניעת שגיאות ולשמירה על תקינות הנתונים.
- **שיפור חוויית ניהול:** כל שינוי (סגירה, מחיקה, עדכון) משפיע מיידית על הרשימה ומסונכרן עם מסד הנתונים.
- **עגלת קניות משופרת:** ניהול קל יותר של פריטים עם אפשרויות עריכה
- **מעקב הזמנות:** חיפוש מתקדם לפי שם או מספר טלפון
- **ניהול לקוחות:** מעקב אחר לקוחות והיסטוריית הזמנות
- **ניתוח מתקדם:** ניתוחים מקיפים עם קישור ללקוחות
- **תיקון NameError:** הוספת PRODUCT_PRICES לאפליקציית הלקוחות
- **ניקוי מבנה הפרויקט:** הסרת תיקיות כפולות וקבצים מיותרים 

